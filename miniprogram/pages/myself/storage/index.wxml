<scroll-view class="page-content" scroll-y>
    
    <view class="wine-list">
        <block wx:for="{{wineList}}" wx:key="index">
            <view class="list-item">
                <view class="item-header">
                    <text class="order-no">寄存单号: {{item.orderNo}}</text>
                    <text class="status">{{item.status}}</text>
                </view>
                <view class="item-body">
                    <image class="wine-img" src="{{item.imageUrl || '/images/default_wine.png'}}" mode="aspectFill"></image>
                    <view class="info-details">
                        <text class="wine-name">{{item.name}}</text>
                        <text class="period">有效期: {{item.startDate}}至{{item.endDate}}</text>
                        <text class="remark">备注: {{item.remark}}</text>
                    </view>
                    <view class="actions">
                        <text class="quantity">x{{item.quantity}}</text>
                        <button class="action-btn">立刻取酒</button>
                    </view>
                </view>
            </view>
        </block>
    </view>

    <view class="footer-spacer"></view>
</scroll-view>

<view class="bottom-float-btn-wrap">
    <button class="store-wine-btn" bindtap="showModal">立即存酒</button>
</view>


<view class="modal-mask" wx:if="{{isModalVisible}}" bindtap="hideModal"></view>
<view class="modal-dialog" wx:if="{{isModalVisible}}">
    <view class="modal-title">寄存新酒</view>
    <form bindsubmit="submitForm">
        <view class="form-item upload-box" bindtap="chooseImage">
            <image wx:if="{{formData.imageUrl}}" src="{{formData.imageUrl}}" mode="aspectFill" class="uploaded-img"></image>
            <view wx:else class="placeholder-icon">+</view>
            <text class="label">上传图片</text>
        </view>

        <view class="form-item input-item">
            <text class="label">酒名:</text>
            <input name="wineName" placeholder="请输入酒名" value="{{formData.wineName}}" />
        </view>
        
        <picker mode="date" value="{{formData.validityDate}}" start="{{currentDate}}" bindchange="bindDateChange">
            <view class="form-item input-item picker-item">
                <text class="label">有效期至:</text>
                <view class="picker-value">{{formData.validityDate || '请选择到期时间'}}</view>
            </view>
        </picker>

        <view class="form-item input-item">
            <text class="label">备注:</text>
            <input name="remark" 
                   placeholder="最多10个字" 
                   maxlength="10" 
                   value="{{formData.remark}}"
                   bindinput="bindRemarkInput" />
        </view>
        <text class="word-count">{{formData.remark.length || 0}}/10</text>
        
        <button form-type="submit" class="submit-btn">确认存酒</button>
    </form>
</view>